# Git LFS 자체 호스팅 권장 사양(규모별 가이드)

> 전제: 깃 저장소는 GitHub에 두고, **LFS 오브젝트만** 자체 서버(또는 오브젝트 스토리지)에 저장하는 구성입니다. LFS 서버는 Git LFS **표준 API**(HTTP)를 구현한 솔루션이면 됩니다.

## 어떤 서버를 쓰나요?
- **Giftless**(Python): 로컬 디스크·S3·GCS·Azure Blob 등 다양한 백엔드 지원. 경량/확장 쉬움.  
- **Artifactory**: 엔터프라이즈 기능과 함께 LFS 서버 역할. 사용자 수에 따른 공식 권장 사양 제공.  
- **lfs-test-server**: 학습·테스트용(프로덕션 비권장).  
- **오브젝트 스토리지**: LFS는 보통 오브젝트 스토리지를 콘텐츠 저장소로 사용합니다(예: S3/MinIO).

---

## 규모별 “시작 사양”(온프레미스 기준)

| 팀 규모(활동 사용자) | CPU | RAM | 스토리지(속도/용량) | 네트워크(대역) | 용도/비고 |
|---|---:|---:|---:|---:|---|
| 1–5명 | 2 vCPU | 4 GB | NVMe SSD 250 GB+ | 200–500 Mbps 대칭 | 개인/소규모 팀. GitHub Actions 등 외부 CI가 자주 받으면 업링크 중요 |
| 6–20명 | 4–8 vCPU | 8–16 GB | NVMe SSD 1–2 TB **또는** S3/MinIO | 1 Gbps 대칭 | 소형 스튜디오. 백엔드로 S3/MinIO 쓰면 서버 디스크 부담↓ |
| 20–100명 | 8–16 vCPU | 16–32 GB | NVMe SSD 2–10 TB **또는** S3/MinIO | 1–10 Gbps(최소 1 Gbps) | 중형 이상. 엔터프라이즈 솔루션(Artifactory 등) 고려 |

> 참고: 엔터프라이즈급(예: Artifactory)의 공식 권장치(활동 클라이언트 0–20명: 4코어/6GB, 20–100명: 6코어/12GB, 100–200명: 8코어/18GB)를 상위 규모 설계 참고값으로 삼으면 안전합니다.

---

## 용량·성능 산정 팁

- **저장 용량**  
  LFS 오브젝트는 **SHA-256 OID** 기준으로 콘텐츠 주소화되어 저장됩니다(동일 파일은 중복 저장되지 않음).  
  **대략**: `필요 용량 ≈ 고유 LFS 파일 총합 × 보존 기간(버전 수)` (압축/중복제거 효과는 백엔드에 따라 상이)

- **네트워크 대역**  
  Git LFS 클라이언트는 기본 **동시 전송 3개**로 병렬 업/다운로드합니다(클라이언트 설정으로 조정 가능). 사용자 수 × 동시성 × 평균 파일 크기에 맞춰 업/다운 대역폭을 잡으세요.

- **디스크**  
  작은 파일 다건 전송이 잦으므로 **HDD 대신 SSD/NVMe** 권장. 오브젝트 스토리지를 쓰면 애플리케이션 서버는 **소용량 SSD + 높은 네트워크**로 충분한 경우가 많습니다.

---

## 추천 아키텍처(두 가지)

1) **경량/확장형**: Giftless + S3/MinIO  
- 앱 서버: 2–4 vCPU, 4–8 GB RAM, 소용량 SSD  
- 저장소: S3/MinIO에 무제한 확장  
- 장점: 손쉬운 수평확장, 백업/보존정책을 스토리지에서 해결.

2) **올인원**: Artifactory LFS  
- 사용자 수 기준 **공식 권장 사양**으로 시작 → 필요 시 상향  
- 장점: 권한/감사/프록시 등 엔터프라이즈 기능 일체 제공.

---

## 운영 체크리스트(요약)

- **TLS/리버스 프록시**(Nginx/Traefik)로 HTTPS 종단  
- **백업**: 오브젝트 스토리지 버저닝·수명주기(라이프사이클) 정책 활용  
- **모니터링**: 4xx/5xx 비율, 업/다운 대역, 저장소 사용량 알림  
- **클라이언트 설정 가이드**: 필요 시 `lfs.concurrenttransfers` 상향, CI에는 `lfs: true` 체크아웃 등.  
- **테스트 서버 주의**: `lfs-test-server`는 프로덕션 비권장. PoC 용도로만.

---

### 한 줄 결론
- **소·중규모 팀**: *Giftless + S3/MinIO*에 **2–8 vCPU / 4–16 GB RAM / 1 Gbps 링크**면 충분히 시작합니다.  
- **엔터프라이즈**: *Artifactory LFS*의 **공식 권장 사양**을 기준으로 잡고, 사용자 증가에 맞춰 선형 확장하세요.